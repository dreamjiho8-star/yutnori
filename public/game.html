<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>윷놀이 - 게임</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body class="game-page">
  <div class="game-wrapper">
    <div class="game-main">
      <canvas id="board-canvas" width="600" height="600"></canvas>
      <div class="throw-area" id="throw-area">
        <div class="yut-sticks" id="yut-sticks">
          <div class="stick"></div>
          <div class="stick"></div>
          <div class="stick"></div>
          <div class="stick"></div>
        </div>
        <div class="throw-result" id="throw-result"></div>
        <button class="btn-throw" id="btn-throw" disabled>윷 던지기</button>
      </div>
    </div>

    <div class="game-sidebar">
      <div class="sidebar-header">
        <span class="sidebar-title">윷놀이</span>
        <button class="btn-icon" id="btn-sound" title="사운드">🔊</button>
        <button class="sidebar-collapse-btn" id="sidebar-collapse" title="패널 접기/펴기">▼</button>
      </div>

      <div class="turn-indicator" id="turn-indicator">
        <span class="turn-label">현재 차례</span>
        <span class="turn-player" id="turn-player">-</span>
      </div>

      <div class="section">
        <h3>플레이어</h3>
        <div id="player-list"></div>
      </div>

      <div class="section" id="pending-moves-area">
        <h3>사용할 이동</h3>
        <div id="move-timer-bar" class="move-timer-bar hidden">
          <div id="move-timer-fill" class="move-timer-fill"></div>
          <span id="move-timer-text" class="move-timer-text">10</span>
        </div>
        <div id="pending-moves-list"></div>
      </div>

      <div class="section hidden" id="token-select">
        <h3>이동할 말 선택</h3>
        <div id="token-buttons"></div>
        <button class="btn-skip" id="btn-skip" style="display:none">빽도 건너뛰기</button>
      </div>

      <div class="section game-log-section">
        <div class="log-chat-tabs">
          <button class="log-chat-tab" id="tab-log" data-tab="log">게임 로그</button>
          <button class="log-chat-tab active" id="tab-chat" data-tab="chat">💬 채팅</button>
        </div>
        <div id="game-log" class="hidden"></div>
        <div id="game-chat">
          <div id="game-chat-messages"></div>
          <div class="game-chat-input-area">
            <input type="text" id="game-chat-input" placeholder="메시지 입력..." maxlength="200" autocomplete="off">
            <button class="game-chat-send" id="game-chat-send">전송</button>
          </div>
        </div>
      </div>

      <div class="credits-footer-game">
        <span>운영자 : 최지호</span> · <span>Special Thanks To SJ</span>
      </div>
    </div>

    <div class="ai-chat-panel" id="ai-chat-panel">
      <div class="ai-chat-header">
        <span class="ai-chat-title">AI 조언자</span>
        <button class="btn-icon" id="btn-toggle-ai" title="AI 패널 접기">✕</button>
      </div>
      <div class="ai-chat-messages" id="ai-chat-messages">
        <div class="ai-msg ai-msg-bot">안녕하세요! 윷놀이 AI 조언자입니다. 게임 상황을 실시간으로 보고 있어요. 질문하세요!</div>
      </div>
      <div class="ai-chat-input-area">
        <input type="text" id="ai-chat-input" placeholder="AI에게 질문하기..." autocomplete="off">
        <button class="ai-chat-send" id="ai-chat-send">전송</button>
      </div>
      <div class="ai-quick-btns">
        <button class="ai-quick-btn" data-q="지금 어떤 말을 움직이는 게 좋을까?">전략 추천</button>
        <button class="ai-quick-btn" data-q="현재 게임 상황을 분석해줘">상황 분석</button>
        <button class="ai-quick-btn" data-q="상대방 말을 잡을 수 있는 방법이 있을까?">잡기 찬스</button>
      </div>
    </div>
  </div>

  <!-- AI Toggle Button (when panel is hidden) -->
  <button class="ai-toggle-btn hidden" id="ai-toggle-btn" title="AI 조언자 열기">AI</button>

  <!-- Win Modal -->
  <div class="modal hidden" id="win-modal">
    <div class="modal-content">
      <div class="win-icon">🏆</div>
      <h2 id="win-text"></h2>
      <button class="btn btn-gold" id="btn-back-to-room" style="margin-bottom:8px;">같은 멤버로 다시하기</button>
      <button class="btn" onclick="location.href='/'">로비로 돌아가기</button>
    </div>
  </div>

  <!-- Disconnect Overlay -->
  <div class="overlay hidden" id="disconnect-overlay">
    <div class="overlay-content">
      <div class="spinner"></div>
      <div class="overlay-text">재접속 중...</div>
    </div>
  </div>

  <script>
    // 모바일 사이드바 접기/펴기
    const collapseBtn = document.getElementById('sidebar-collapse');
    const sidebar = document.querySelector('.game-sidebar');
    if (collapseBtn) {
      collapseBtn.addEventListener('click', () => {
        sidebar.classList.toggle('collapsed');
        collapseBtn.textContent = sidebar.classList.contains('collapsed') ? '▲' : '▼';
      });
    }
  </script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/sound.js"></script>
  <script src="/js/game.js"></script>
</body>
</html>
